{% load static %}
{% load i18n %}
{% load rest_framework %}
<!DOCTYPE html>
<html lang="en-UK">
<head>
    <title>ATLAS Forced Photometry</title>
    <meta charset="utf-8">
    {% block style %}
      {% block bootstrap_theme %}
        <link rel="stylesheet" type="text/css" href="{% static "rest_framework/css/bootstrap.min.css" %}"/>
        <link rel="stylesheet" type="text/css" href="{% static "rest_framework/css/bootstrap-tweaks.css" %}"/>
      {% endblock %}

      <!-- <link rel="stylesheet" type="text/css" href="{% static "rest_framework/css/prettify.css" %}"/> -->
      <!-- <link rel="stylesheet" type="text/css" href="{% static "rest_framework/css/default.css" %}"/> -->
      {% if code_style %}<style>{{ code_style }}</style>{% endif %}
    {% endblock %}

    <style>
    html {
        /* background-color: #132C48; */
        background-color: rgb(244, 246, 249);
        color: black;
    }

    input {
        padding: 0.1em 10px;
        margin: 8px 0;
        box-sizing: border-box;
    }

    input::placeholder {
      color: #d3d3d3;
    }

    .submit {
        background-color: #6BA3E8;
    }

    body {
        width: 50%;
        min-width: 700px;
        margin: 20px auto;
        padding: 40px;
        /* background-color: #fff; */
        background-color: white;
        border-radius: 0.5em;
        box-shadow: 5px 5px 7px 7px rgba(0,0,0,0.15);
        font-size: 18px;
    }

    ul#tasks li {
        background-color: rgb(100, 150, 200);
        /* background-color: rgb(128,128,128); */
        /* background-color: #ffae19; */
        margin: 1em 0;
        padding: 1em;
        /* box-shadow: 10px -1px 0.8em -4px rgba(0,0,0,0.75); */
        border-radius: 0.5em;
        border: 0.1em solid rgb(0, 0, 0, 0.6);
    }

    ul#tasks li.queued {
        background-color: rgba(0, 0, 0, 0.1);
        border: none;
        color: grey;
    }

    ul#tasks li.finished {
        background-color: white;
    }

    .btn-danger {
        /* background-color: #ff4e19; */
        /* border-color: #e59400; */
        float: right;
    }

    form li div:nth-child(1) {
        display: inline-block;
        text-align: right;
        width: 5em;
        margin-right: 10px;
        vertical-align: center;
    }

    form li div:nth-child(2) {
        display: inline;
        width: auto;
        text-align: left;
    }

    ul {
        list-style: none;
        padding: 0;
    }

    a.results {
        border-color: #e59400;
        background-color: #ef4e19;
        /* background-color: #6BA3E8; */
        color: white;
        display: block;
        clear: both;
        margin-top: 1em;
        width: 9em;
    }
    </style>
</head>
<body>
    <div class="wrapper">
      {% block navbar %}
        <div class="navbar navbar-static-top {% block bootstrap_navbar_variant %}navbar-inverse{% endblock %}"
             role="navigation" aria-label="{% trans "navbar" %}">
          <div class="container">
            <span>
              {% block branding %}
                <h1><a class='navbar-brand' rel="nofollow" href='#'>
                    ATLAS Forced Photometry
                </a></h1>
              {% endblock %}
            </span>
            <ul class="nav navbar-nav pull-right">
              {% block userlinks %}
                {% if user.is_authenticated %}
                  {% optional_logout request user %}
                {% else %}
                  {% optional_login request %}
                {% endif %}
              {% endblock %}
            </ul>
          </div>
        </div>
      {% endblock %}


    <h2>New request</h2>
    <form method="POST" action="/">
        {% csrf_token %}
        <ul>
            <li><div>{{ form.ra.label_tag }}</div><div>{{ form.ra }}</div></li>
            <li><div>{{ form.dec.label_tag }}</div><div>{{ form.dec }}</div></li>
            <li><div>{{ form.mjd_min.label_tag }}</div><div>{{ form.mjd_min }}</div></li>
            <li><div>{{ form.mjd_max.label_tag }}</div><div>{{ form.mjd_max }}</div></li>
            <li><div>{{ form.use_reduced }}</div><div>{{ form.use_reduced.label_tag }}</div></li>
        </ul>
        <input class="btn btn-info" type="submit" name="Create Task" value="Request" />
    </form>

    <h2>Previous requests</h2>
    <ul id="tasks">

    {% for task in tasks %}
        {% if task.finished %}
        <li class="item-row finished">
            <a class="btn btn-sm btn-danger" href="{% url 'delete' task.id %}">Delete</a>
        {% else %}
        <li class="item-row queued">
            <a class="btn btn-sm btn-danger" href="{% url 'delete' task.id %}">Cancel</a>
        {% endif %}
            RA: {{task.ra}}<br/>
            DEC: {{task.dec}}<br/>
            {% if task.finished %}
            Finished<br/>
            <a class="results btn btn-sm" href="/{{task.get_localresultfile}}">Results</a>
            {% else %}
            Queued
            {% endif %}
            <!-- Email: {{task.user.email}} -->
        </li>
    {% endfor %}

    </ul>

    {% block script %}
      <script>
        window.drf = {
          csrfHeaderName: "{{ csrf_header_name|default:'X-CSRFToken' }}",
          csrfToken: "{% if request %}{{ csrf_token }}{% endif %}"
        };
      </script>
      <script src="{% static "rest_framework/js/jquery-3.5.1.min.js" %}"></script>
      <script src="{% static "rest_framework/js/ajax-form.js" %}"></script>
      <script src="{% static "rest_framework/js/csrf.js" %}"></script>
      <script src="{% static "rest_framework/js/bootstrap.min.js" %}"></script>
      <script src="{% static "rest_framework/js/prettify-min.js" %}"></script>
      <script src="{% static "rest_framework/js/default.js" %}"></script>
      <script>
        $(document).ready(function() {
          $('form').ajaxForm();
        });
      </script>
    {% endblock %}
</body>
</html>